[tox]
envlist = py38,py39,py310,py311,py312
isolated_build = True

[testenv]
deps =
    gunicorn
    pytest
    pytest-cov
    # Optional dependencies for workers
    gevent>=23.7.0
    eventlet>=0.33.3
    tornado>=6.3.3
    # Test dependencies
    pytest-cov>=4.0.0
    black>=24.2.0
    isort>=5.0.0
    flake8>=4.0.0

commands =
    pytest --cov=gunicorn_prometheus_exporter --cov-report=xml

[testenv:lint]
deps =
    black>=24.2.0
    isort>=5.0.0
    flake8>=4.0.0

commands =
    black --check src tests
    isort --check-only src tests
    flake8 src tests

[flake8]
max-line-length = 88
extend-ignore =
    E203,   # whitespace before ':'
    D205,   # blank line after summary
    D400,   # summary must end with period
    D100,   # public module missing docstring
    D101,   # public class missing docstring
    D102,   # public function missing docstring
    D107,   # missing docstring in __init__
    Q000,   # quote-style complaints
    I101,   # import-order name grouping
    E266,   # too many '#'
exclude = .git,__pycache__,build,dist,*.egg-info,example
per-file-ignores =
    __init__.py:F401,F403

[isort]
profile = black
multi_line_output = 3
include_trailing_comma = True
force_grid_wrap = 0
use_parentheses = True
ensure_newline_before_comments = True
line_length = 88
